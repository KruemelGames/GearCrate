<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GearCrate - Star Citizen Inventory Manager</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <div class="header-left">
					<h1><img id="gear-logo" src="/img/GearCrate_Logo.png" alt="GearCrate Logo"> <span data-i18n="appTitle">GearCrate</span></h1>
                    <p class="subtitle">Star Citizen Inventory Manager</p>
                </div>
                <div class="header-right">
                    <div class="language-selector">
                        <label data-i18n="language">Language:</label>
                        <select id="language-select">
                            <option value="de">ğŸ‡©ğŸ‡ª Deutsch</option>
                            <option value="en">ğŸ‡¬ğŸ‡§ English</option>
                            <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
                            <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
                        </select>
                    </div>
                </div>
            </div>
        </header>

        <!-- VIEW NAVIGATION -->
        <section class="view-navigation">
            <button id="view-btn-inventory" class="view-btn active">ğŸ“¦ <span data-i18n="inventory">Inventar</span></button>
            <button id="view-btn-gearsets" class="view-btn">ğŸ¯ Gear Sets</button>
            <button id="view-btn-import" class="view-btn">ğŸ“¥ Import from SC</button>
        </section>

        <!-- MAIN CONTENT AREA (wird gewechselt) -->
        <div id="main-content">
            <!-- Inventar View -->
            <div id="inventory-view" class="content-view active">
                <!-- Search Section -->
                <section class="search-section">
                    <h2>ğŸ” <span data-i18n="search">Suche</span></h2>
                    <div class="search-controls">
                        <input type="text" id="search-input" data-i18n-placeholder="searchPlaceholder" placeholder="Suche Items...">
                        <div class="search-limit-wrapper">
                            <label data-i18n="searchLimit">Ergebnisse zeigen:</label>
                            <select id="search-limit">
                                <option value="10">10</option>
                                <option value="25" selected>25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                                <option value="999" data-i18n="categoryAll">Alle</option>
                            </select>
                        </div>
                    </div>
                    <div id="search-results" class="search-results hidden"></div>
                    <div id="item-preview" class="item-preview hidden">
                        <h3 id="preview-name"></h3>
                        <p id="preview-type"></p>
                        <img id="preview-image" src="" alt="Preview">
                        <button id="add-button" data-i18n="add">HinzufÃ¼gen</button>
                    </div>
                </section>

                <!-- Inventory Section -->
                <section class="inventory-section">
            <div class="inventory-header">
                <!-- H2 ENTFERNT -->
                
                <!-- NEW: Button-based Controls -->
                <div class="inventory-controls-wrapper">
                    <!-- Left: Sortierung -->
                    <div class="control-section">
                        <h3 class="control-title">ğŸ”€ <span data-i18n="sortBy">Sortieren nach:</span></h3>
                        <div class="button-group">
                            <button class="sort-btn active" data-sort="name">
                                ğŸ“ <span data-i18n="sortName">Name</span>
                            </button>
                            <button class="sort-btn" data-sort="count">
                                ğŸ”¢ <span data-i18n="sortCount">Anzahl</span>
                            </button>
                            <button class="sort-btn" data-sort="date">
                                ğŸ“… <span data-i18n="sortDate">Datum</span>
                            </button>
                        </div>
                        <button id="sort-order-btn" class="order-btn" data-i18n="sortAscending">
                            â¬‡ï¸ Aufsteigend
                        </button>
                    </div>
                    
                    <!-- Right: Kategorien -->
                    <div class="control-section">
                        <h3 class="control-title">ğŸ·ï¸ Kategorien</h3>
                        <div id="category-buttons" class="category-grid">
                            <!-- Buttons werden dynamisch geladen -->
                            <div style="color: #666; padding: 10px;" data-i18n="categoryLoading">Kategorien werden geladen...</div>
                        </div>
                    </div>
                </div>
                
                <!-- Text Filter -->
                <div class="text-filter">
                    <input type="text" id="filter-input" data-i18n-placeholder="inventoryFilter" placeholder="Inventar filtern...">
                </div>
            </div>
            
            <div id="inventory-grid" class="inventory-grid">
                <p style="text-align: center; color: #888;" data-i18n="inventoryEmpty">Lade Inventar...</p>
            </div>
        </section>
            </div>
            <!-- Ende Inventar View -->

            <!-- Gear Sets View -->
            <div id="gearsets-view" class="content-view">
                <section class="gearsets-section">
                    <!-- Sticky Header -->
                    <div class="gearsets-header">
                        <!-- H2 ENTFERNT -->
                        
                        <!-- Set Selector Buttons -->
                        <div class="gearsets-selector">
                            <h3 class="control-title">ğŸ¯ Set auswÃ¤hlen:</h3>
                            <div id="set-buttons" class="set-buttons-grid">
                                <button class="set-btn active" data-set="ADP">ADP</button>
                                <!-- Buttons werden dynamisch geladen -->
                                <button class="set-btn set-btn-all" data-set="ALL">ğŸŒ Alle Sets</button>
                            </div>
                        </div>
                        
                        <!-- Filter Buttons -->
                        <div class="gearsets-filter">
                            <button class="filter-btn active" data-filter="all">Alle</button>
                            <button class="filter-btn" data-filter="none">ğŸ”´ None (0/4)</button>
                            <button class="filter-btn" data-filter="1">ğŸ”µ 1/4</button>
                            <button class="filter-btn" data-filter="2">ğŸ”µ 2/4</button>
                            <button class="filter-btn" data-filter="3">ğŸ”µ 3/4</button>
                            <button class="filter-btn" data-filter="all-parts">ğŸŸ¢ ALL (4/4)</button>
                        </div>
                    </div>
                    
                    <!-- Gear Sets Grid (scrollbar) -->
                    <div id="gearsets-grid" class="gearsets-grid">
                        <p style="text-align: center; color: #888;">Lade Gear Sets...</p>
                    </div>
                </section>
            </div>
            <!-- Ende Gear Sets View -->

            <!-- Import from SC View -->
            <div id="import-view" class="content-view">
                <section class="import-section">
                    <!-- Before Scan State -->
                    <div id="import-before-scan" class="import-state">
                        <h2 data-i18n="importTitle">ğŸ“¥ Import from Star Citizen</h2>

                        <!-- Admin Rights Warning -->
                        <div class="admin-warning">
                            <h3 data-i18n="importAdminRequired">âš ï¸ Administrator-Rechte erforderlich</h3>
                            <p data-i18n="importAdminWarning1">Der InvDetect Scanner benÃ¶tigt Admin-Rechte fÃ¼r Tastatur-Hooks und Fenster-Switching.</p>
                            <p data-i18n="importAdminWarning2" data-i18n-html="true"><strong>Bitte verwende:</strong> <code>start-browser-admin.bat</code> oder <code>start-desktop-admin.bat</code></p>
                            <p data-i18n="importAdminWarning3">Ohne Admin-Rechte wird der Scanner nicht funktionieren.</p>
                        </div>

                        <!-- Scan Mode Selection -->
                        <div class="scan-mode-selection">
                            <h3 data-i18n="importSelectScanMode">ğŸ¯ Scan Mode wÃ¤hlen:</h3>
                            <div class="mode-buttons">
                                <button class="mode-btn active" data-mode="1">
                                    <div class="mode-icon">ğŸ“¦</div>
                                    <div class="mode-title" data-i18n="importMode1Title">1x1 Items</div>
                                    <div class="mode-description" data-i18n="importMode1Desc">Normal (Waffen, RÃ¼stungen, etc.)</div>
                                </button>
                                <button class="mode-btn" data-mode="2">
                                    <div class="mode-icon">ğŸ‘”</div>
                                    <div class="mode-title" data-i18n="importMode2Title">1x2 Items</div>
                                    <div class="mode-description" data-i18n="importMode2Desc">Undersuits</div>
                                </button>
                            </div>
                        </div>

                        <!-- Instructions -->
                        <div class="scan-instructions">
                            <h3 data-i18n="importInstructions">ğŸ“‹ Anleitung:</h3>
                            <ol>
                                <li data-i18n="importStep1">WÃ¤hle den passenden Scan-Modus (1x1 oder 1x2)</li>
                                <li data-i18n="importStep2">Klicke auf "Scan Now"</li>
                                <li data-i18n="importStep3">Ein CMD-Fenster Ã¶ffnet sich mit "Press INSERT to start scan..."</li>
                                <li data-i18n="importStep4">Wechsle zu Star Citizen und Ã¶ffne dein Universal Inventory</li>
                                <li data-i18n="importStep5">DrÃ¼cke INSERT zum Starten</li>
                                <li data-i18n="importStep6">Der Scanner arbeitet automatisch</li>
                                <li data-i18n="importStep7" data-i18n-html="true"><strong>Abbruch:</strong> DrÃ¼cke DELETE oder bewege Maus in Bildschirmecke</li>
                                <li data-i18n="importStep8">Nach dem Scan werden die Ergebnisse hier angezeigt</li>
                            </ol>
                            <div class="scan-tip">
                                <span data-i18n="importTip" data-i18n-html="true">ğŸ’¡ <strong>Tipp:</strong> Stelle sicher, dass Star Citizen im Vollbild-Modus lÃ¤uft (1920x1080) fÃ¼r beste Ergebnisse.</span>
                            </div>
                        </div>

                        <!-- Start Scan Button -->
                        <button id="start-scan-btn" class="scan-btn" data-i18n="importScanNow">
                            ğŸš€ Scan Now
                        </button>
                    </div>

                    <!-- During Scan State -->
                    <div id="import-during-scan" class="import-state hidden">
                        <h2 data-i18n="importScanning">â³ Scan lÃ¤uft...</h2>
                        <p data-i18n="importScannerActive">Der Scanner ist aktiv. Bitte folge den Anweisungen im CMD-Fenster.</p>
                        <p data-i18n="importCancelInfo" data-i18n-html="true"><strong>Abbruch:</strong> DELETE-Taste oder Maus in Bildschirmecke</p>
                        <button id="check-results-btn" class="scan-btn" data-i18n="importCheckResults">
                            ğŸ” Ergebnisse prÃ¼fen
                        </button>
                    </div>

                    <!-- After Scan State - Results -->
                    <div id="import-after-scan" class="import-state hidden">
                        <h2 data-i18n="importScanComplete">âœ… Scan abgeschlossen</h2>

                        <!-- Category Filter for Results -->
                        <div class="import-controls">
                            <h3 data-i18n="importCategoryFilter">ğŸ·ï¸ Kategorie Filter:</h3>
                            <div id="import-category-buttons" class="category-grid">
                                <!-- Dynamic category buttons -->
                            </div>
                        </div>

                        <!-- Undo/Redo Controls -->
                        <div class="import-undo-controls">
                            <button id="undo-btn" class="undo-btn" disabled data-i18n="importUndo">â†¶ Undo</button>
                            <button id="redo-btn" class="redo-btn" disabled data-i18n="importRedo">â†· Redo</button>
                        </div>

                        <!-- Found Items -->
                        <div class="import-results-section">
                            <h3 data-i18n="importFoundItems">âœ… Gefundene Items (<span id="found-count">0</span>)</h3>
                            <div id="import-found-grid" class="import-grid">
                                <!-- Dynamic grid items -->
                            </div>
                        </div>

                        <!-- Not Found Items -->
                        <div class="import-results-section">
                            <h3 data-i18n="importNotFoundItems">â“ Nicht erkannte Items (<span id="notfound-count">0</span>)</h3>
                            <div id="import-notfound-list" class="import-notfound-list">
                                <!-- Dynamic list items -->
                            </div>
                            <button id="open-notdetected-btn" class="secondary-btn" data-i18n="importOpenNotDetected">
                                ğŸ“„ not_detected.md Ã¶ffnen
                            </button>
                        </div>

                        <!-- Import Actions -->
                        <div class="import-actions">
                            <button id="import-items-btn" class="scan-btn" data-i18n="importImportItems">
                                âœ… Items importieren
                            </button>
                            <button id="new-scan-btn" class="secondary-btn" data-i18n="importNewScan">
                                ğŸ”„ Neuer Scan
                            </button>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Ende Import View -->
        </div>
        <!-- Ende Main Content -->

        <!-- Stats Section -->
        <section class="stats-section">
            <h2>ğŸ“Š <span data-i18n="statsTitle">Statistiken</span></h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-label" data-i18n="statsTotalInDb">Items in Datenbank:</span>
                    <span class="stat-value" id="total-items-db">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" data-i18n="statsInInventory">Items im Inventar:</span>
                    <span class="stat-value" id="inventory-unique-items">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" data-i18n="statsTotalCount">Gesamtanzahl:</span>
                    <span class="stat-value" id="total-count">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" data-i18n="statsCacheSize">Cache-GrÃ¶ÃŸe:</span>
                    <span class="stat-value" id="cache-size">0 MB</span>
                </div>
            </div>
            
            <!-- Kategorie-Statistiken (dynamisch) -->
            <div id="category-stats" class="category-stats"></div>
        </section>
    </div>

    <!-- Item Detail Modal -->
    <div id="item-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modal-name"></h2>
            <img id="modal-image" src="" alt="Item Image">
            <div class="modal-controls">
                <label data-i18n="modalCount">Anzahl:</label>
                <div class="count-controls">
                    <button onclick="changeCount(-1)">âˆ’</button>
                    <input type="number" id="modal-count" min="0" value="0">
                    <button onclick="changeCount(1)">+</button>
                </div>
            </div>
            <div class="modal-controls">
                <label data-i18n="modalNotes">Notizen:</label>
                <textarea id="modal-notes" rows="4" placeholder="Optionale Notizen..."></textarea>
            </div>
            <div class="modal-actions">
                <button onclick="deleteItem()" class="delete-btn" data-i18n="delete">LÃ¶schen</button>
            </div>
        </div>
    </div>

    <!-- Translation Scripts (LOAD FIRST!) -->
    <script src="translations/german-translation.js"></script>
    <script src="translations/english-translation.js"></script>
    <script src="translations/french-translation.js"></script>
    <script src="translations/spanish-translation.js"></script>
    <script src="translations/translations.js"></script>
    
    <!-- Fuse.js for smart search -->
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
    
    <!-- Footer with utility buttons -->
    <footer class="app-footer">
        <div class="footer-buttons">
            <button id="clear-cache-btn" class="footer-btn" data-i18n="footerClearCache" title="Clear website cache and reload">
                ğŸ—‘ï¸ Clear Cache
            </button>
            <button id="debug-btn" class="footer-btn" data-i18n="footerDebug" title="Open DevTools">
                ğŸ› Debug
            </button>
            <button id="clear-inventory-btn" class="footer-btn" data-i18n="footerClearInventory" title="Set all item counts to 0">
                ğŸ“¦ Clear Inventory
            </button>
        </div>
    </footer>

    <!-- App Scripts -->
    <script src="api-adapter.js"></script>
    <script src="app.js"></script>
    <script src="i18n-integration.js"></script>
</body>
</html>
